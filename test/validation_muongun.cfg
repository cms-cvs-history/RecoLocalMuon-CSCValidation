process TEST = {

  source = PoolSource {
       untracked vstring fileNames = {
        "file:/uscms_data/d1/akub19/muon_gun_01.root",
        "file:/uscms_data/d1/akub19/muon_gun_02.root",
        "file:/uscms_data/d1/akub19/muon_gun_03.root",
        "file:/uscms_data/d1/akub19/muon_gun_04.root",
        "file:/uscms_data/d1/akub19/muon_gun_05.root",
        "file:/uscms_data/d1/akub19/muon_gun_06.root",
        "file:/uscms_data/d1/akub19/muon_gun_07.root",
        "file:/uscms_data/d1/akub19/muon_gun_08.root",
        "file:/uscms_data/d1/akub19/muon_gun_09.root",
        "file:/uscms_data/d1/akub19/muon_gun_10.root"
       }
  }


  untracked PSet maxEvents = {untracked int32 input = -1}

# Specify the output file for the reconstructed events.
  module out = PoolOutputModule {
    untracked string fileName ="eventsOutput.root"
  }

# These are some useful utilities.
#  service = Timing { }
#  service = SimpleMemoryCheck { }

# These are some geometry modules needed for recHits and segments
  include "Geometry/MuonCommonData/data/muonIdealGeometryXML.cfi"
  include "Geometry/CSCGeometry/data/cscGeometry.cfi"
  es_module = MuonNumberingInitialization { }

### "Fake" DB
include "CalibMuon/Configuration/data/CSC_FakeDBConditions.cff"
### Frontier DB
#include "CalibMuon/Configuration/data/CSC_FrontierConditions.cff"
#es_source=CSCFrontierConditions{}


# Need access to calibration constants.
#
# This comes from Oana !
#
#        es_source = PoolDBESSource { 
#          VPSet toGet = {
#             { string record = "CSCGainsRcd"
#               string tag    = "CSCGains_ideal" },
#             { string record = "CSCPedestalsRcd"
#               string tag    = "CSCPedestals_ideal" },
#             { string record = "CSCNoiseMatrixRcd"
#               string tag    = "CSCNoiseMatrix_ideal" },
#             { string record = "CSCcrosstalkRcd"
#               string tag    = "CSCCrosstalk_ideal" }
#                                    }
#           bool loadAll = true
#           string connect="oracle://cms_orcoff_int2r/CMS_COND_CSC"
#           untracked string catalog = "relationalcatalog_oracle://cms_orcoff_int2r/CMS_COND_GENERAL"
#           string timetype = "runnumber"
#
#           PSet DBParameters = {
#               untracked string authenticationPath="/afs/cern.ch/cms/DB/conddb"
#               untracked uint32 authenticationMethod = 0
#                               }
#        untracked PSet maxEvents = {untracked int32 input = 1}
#     }


#--------------------------------------------------
# Specify the data unpacker, which makes the digi
# (Not needed for simulations...)
#--------------------------------------------------

  module muonCSCDigis = CSCDCCUnpacker {
    untracked bool Debug = false
    untracked bool PrintEventNumber = true
    FileInPath theMappingFile = "CondFormats/CSCObjects/data/csc_slice_test_map.txt"
    untracked bool UseExaminer = true
    untracked uint32 ErrorMask = 0xDFCFEFFF 
    untracked uint32 ExaminerMask = 0x7FB7BF6
    InputTag InputObjects = source
    untracked bool UnpackStatusDigis = false
    untracked bool isMTCCData = false
  }

#--------------------------------------------------
# Specify the recHit reconstruction routine.
#--------------------------------------------------

#  include "RecoLocalMuon/CSCRecHit/data/csc2DRecHits.cfi"
   include "RecoLocalMuon/CSCRecHitB/data/cscRecHitB.cfi"

#--------------------------------------------------
# Specify the segment reconstruction routine.
#--------------------------------------------------

   include "RecoLocalMuon/CSCSegment/data/CSCSegmentAlgorithmSK.cfi"
   include "RecoLocalMuon/CSCSegment/data/CSCSegmentAlgorithmTC.cfi"
   include "RecoLocalMuon/CSCSegment/data/CSCSegmentAlgorithmDF.cfi"
   include "RecoLocalMuon/CSCSegment/data/CSCSegmentAlgorithmST.cfi"

   module cscSegments = CSCSegmentProducer {

    # Define input
    InputTag inputObjects = csc2DRecHits
    
    # Choice of the building algo: 1 SK, 2 TC, 3 DF, 4 ST, ...
    int32 algo_type = 3

    # std::vector<edm::ParameterSet>
    VPSet algo_psets = {
        {using CSCSegAlgoSK}, {using CSCSegAlgoTC}, {using CSCSegAlgoDF},
        {using CSCSegAlgoST}
    }
  }

#--------------------------------------------------
# Finally, specify my user analysis package !
#--------------------------------------------------

module cscValidation = CSCValidation{
    untracked string rootFileName = 'validationHists_muongun.root' 
    untracked bool   isSimulation = true
}

#--------------------------------------------------
# Specify the analysis path and output module.
#--------------------------------------------------
path p = {csc2DRecHits, cscSegments, cscValidation}
#path p = {csc2DRecHits, cscSegments}

# Specify the output:
#	endpath e = {out}

}
